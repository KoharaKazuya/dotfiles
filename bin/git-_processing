#!/bin/sh

set -eu

# å¼•æ•°ã¯ 3 ã¤ä»¥ä¸Šå¿…é ˆ
[ "$#" -ge 3 ]

# ã‚¿ã‚°è¡¨ç¤º
# ä¾‹: [cc ]
printf -- '\e[30m%3s: ' "$1"
shift

# å‡¦ç†ä¸­ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º
# ä¾‹: Merging...
printf -- "$1...\n"
shift

{ if sh -c "$*" 2>&1; then
    printf '\e[1;32mâœ“\e[0m\n'
  else
    printf '\e[1;31mâœ—\e[0m\n'
  fi
} \
| sed -E 's/^/[30m   | [0m/' \
| awk '$0!~/âœ—/;/âœ—/{print;s=1};END{exit s}'
